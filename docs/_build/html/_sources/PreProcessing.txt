***********************
 Pre-Processing Spectra
***********************

--------------------------------------
"Long" correction for glass Raman data
--------------------------------------

The correction of glasses Raman spectra from temperature and excitation line effects (see Le Losq et al. 2014 and references therein) can be done using the function:

    x, long, eselong = long(data,tempe,wave)

INPUTS:

	data: Array{Float64}, input spectrum with x and y in first and second columns respectively;

	temp: Float64, the temperature in Â°C;

	wave: Float64, the wavenumber at which the spectrum was acquirred in nm.

OUTPUTS:

(are combined in one array if only one output name is given)

	x: Array{Float64} containing the x values;

	long: Array{Float64} containing the corrected y values;

	eselong: Array{Float64} containing the errors calculated as sqrt(y) on raw data and propagated after the correction.

------------------------------
Baseline subtraction function
------------------------------

Baseline subtraction can be made with using the baseline function:

    y_corr, bass = baseline(x,y,roi,basetype,p::Array{Float64};SplOrder=3)

INPUTS:

	x: Array{Float64} containing the x values;
	
	y: Array{Float64} containing the y values;
	
	roi: Array{Float64} containing the "region of interest", i.e. the places where you want to fit the baseline. For instance, if the baseline should fit the regions comprised between 750 and 800 cm^{-1}, and 1250 and 1300 cm^{-1}: roi = [750. 800.; 1250. 1300.];

	basetype: AbstractString, the type of baseline that you want to use. For now, polynomial and cubic spline baselines are available. Indicate the type you want as:

		Polynomial baseline: enter "poly" for basetype, then the polynomial degree as p.

		Dierckx cubic spline baseline: enter "Dspline" for basetype, then the smoothing degree as p.

			Generalised Cross-Validated baseline: enter "gsvspline" for basetype, then the smoothing degree as p. 

			note: errors on measurenements are automatically provided as sqrt(y) in gcvspline. For further options, please use the gcvspl and splderivative functions that directly call the GCVSPL and SPLDER function of the gcvspl.f program (Holtring, 1986).

	p:: Array{Float64}, containing the coefficients for the polynomial fit, or the spline smoothing coefficient (still needs to be provided in an array as [1.0] for instance).
	
OPTIONS:

	SplOrder: Integer, the spline coefficient to be used with the Dspline or gcvspline options. Default = 3.
	
	
OUTPUTS:

(are combined in a tuple in one array if only one output variable is provided)

	y_corr: Array{Float64}, the spectrum corrected from its baseline;
	
	bass: Array{Float64}, the baseline.

Further informations for the use of splines are given in the Splines section, see :ref:`Splines`.

----------
Examples
----------

For instance, for subtracting a constant baseline between 1250 and 1300 cm^{-1}:

    roi = [[1250. 1300.]]
	
    basetype = "poly"
	
    p = [1.0]
	
    y_corr, bas = baseline(x,y,roi,"poly",p)
	

For a linear baseline,

    p = [1.0, 1.0]
	
    bas = baseline(x,y,roi,"poly",p)

For a second order polynomial baseline,

    p = [1.0, 1.0, 1.0]
	
    bas = baseline(x,y,roi,"poly",p)

with the last coefficient will be the one in front of x^2. This can continue as you want by adding more 1.0 values to p.

For a cubic spline baseline fitting the basis of a peak centered at 1100 cm$^{-1}$ and with basis at 900 and 1250 cm^{-1}:

    roi = [[890. 910.]; [1250. 1300.]]
	
    basetype = "Dspline"
	
    s = [0.01]
	
    bas = baseline(x,y,roi,basetype,s)

s there is the smoothing parameter used. The cubic spline uses the Dierckx package initially written in Fortran and used in Julia: https://github.com/kbarbary/Dierckx.jl

----------
Tips
----------

- Always be careful to enter float and integer numbers as required by the functions! They will return an error if you do not do that.

- For the spline, do not hesitate to test a broad range in term of order of magnitudes for the smoothing parameter!
